<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="Orcamento.Views.SettingsPage"
             xmlns:vm="clr-namespace:Orcamento.ViewModels"
             x:DataType="vm:SettingsViewModel"
             Title="Configurações">

    <ScrollView>
        <VerticalStackLayout Spacing="20" Padding="20">

            <!-- Perfil do Usuário -->
            <Frame>
                <VerticalStackLayout Spacing="10">
                    <Label Text="Perfil" FontSize="20" FontAttributes="Bold"/>
                    
                    <HorizontalStackLayout Spacing="15">
                        <Border StrokeShape="RoundRectangle 40" 
                                HeightRequest="80" 
                                WidthRequest="80"
                                Stroke="{StaticResource Primary}">
                            <Label Text="👤" FontSize="40" 
                                   HorizontalOptions="Center" 
                                   VerticalOptions="Center"/>
                        </Border>
                        
                        <VerticalStackLayout VerticalOptions="Center">
                            <Label Text="{Binding UserName}" FontSize="18" FontAttributes="Bold"/>
                            <Label Text="{Binding UserEmail}" FontSize="14" TextColor="Gray"/>
                            <Label Text="{Binding UserPlan}" FontSize="12" TextColor="{StaticResource Primary}"/>
                        </VerticalStackLayout>
                    </HorizontalStackLayout>
                    
                    <Button Text="Editar Perfil" 
                            Command="{Binding EditProfileCommand}"
                            HorizontalOptions="Fill"/>
                </VerticalStackLayout>
            </Frame>

            <!-- Sincronização -->
            <Frame>
                <VerticalStackLayout Spacing="10">
                    <Label Text="Sincronização" FontSize="20" FontAttributes="Bold"/>
                    
                    <HorizontalStackLayout Spacing="10">
                        <Label Text="Sincronização Automática" VerticalOptions="Center" HorizontalOptions="Start"/>
                        <Switch IsToggled="{Binding AutoSyncEnabled}" HorizontalOptions="End"/>
                    </HorizontalStackLayout>
                    
                    <Label Text="{Binding LastSyncText}" FontSize="12" TextColor="Gray"/>
                    
                    <Button Text="Sincronizar Agora" 
                            Command="{Binding SyncNowCommand}"
                            IsEnabled="{Binding IsNotSyncing}"/>
                    
                    <ActivityIndicator IsRunning="{Binding IsSyncing}" 
                                       IsVisible="{Binding IsSyncing}"
                                       Color="{StaticResource Primary}"/>
                </VerticalStackLayout>
            </Frame>

            <!-- Notificações -->
            <Frame>
                <VerticalStackLayout Spacing="10">
                    <Label Text="Notificações" FontSize="20" FontAttributes="Bold"/>
                    
                    <HorizontalStackLayout Spacing="10">
                        <Label Text="Alertas de Orçamento" VerticalOptions="Center" HorizontalOptions="Start"/>
                        <Switch IsToggled="{Binding BudgetAlertsEnabled}" HorizontalOptions="End"/>
                    </HorizontalStackLayout>
                    
                    <HorizontalStackLayout Spacing="10">
                        <Label Text="Lembrete de Metas" VerticalOptions="Center" HorizontalOptions="Start"/>
                        <Switch IsToggled="{Binding GoalRemindersEnabled}" HorizontalOptions="End"/>
                    </HorizontalStackLayout>
                </VerticalStackLayout>
            </Frame>

            <!-- Aparência -->
            <Frame>
                <VerticalStackLayout Spacing="10">
                    <Label Text="Aparência" FontSize="20" FontAttributes="Bold"/>
                    
                    <HorizontalStackLayout Spacing="10">
                        <Label Text="Tema Escuro" VerticalOptions="Center" HorizontalOptions="Start"/>
                        <Switch IsToggled="{Binding DarkModeEnabled}" HorizontalOptions="End"/>
                    </HorizontalStackLayout>
                    
                    <Label Text="Moeda" FontSize="16" FontAttributes="Bold"/>
                    <Picker ItemsSource="{Binding AvailableCurrencies}"
                            SelectedItem="{Binding SelectedCurrency}"/>
                </VerticalStackLayout>
            </Frame>

            <!-- Dados e Privacidade -->
            <Frame>
                <VerticalStackLayout Spacing="10">
                    <Label Text="Dados e Privacidade" FontSize="20" FontAttributes="Bold"/>
                    
                    <Button Text="Exportar Dados" 
                            Command="{Binding ExportDataCommand}"
                            HorizontalOptions="Fill"/>
                    
                    <Button Text="Limpar Cache" 
                            Command="{Binding ClearCacheCommand}"
                            HorizontalOptions="Fill"/>
                    
                    <Button Text="Excluir Minha Conta" 
                            Command="{Binding DeleteAccountCommand}"
                            BackgroundColor="Red"
                            TextColor="White"
                            HorizontalOptions="Fill"/>
                </VerticalStackLayout>
            </Frame>

            <!-- Suporte -->
            <Frame>
                <VerticalStackLayout Spacing="10">
                    <Label Text="Suporte" FontSize="20" FontAttributes="Bold"/>
                    
                    <Button Text="Central de Ajuda" 
                            Command="{Binding HelpCenterCommand}"
                            HorizontalOptions="Fill"/>
                    
                    <Button Text="Enviar Feedback" 
                            Command="{Binding SendFeedbackCommand}"
                            HorizontalOptions="Fill"/>
                    
                    <Button Text="Exportar Logs (Suporte)" 
                            Command="{Binding ExportLogsCommand}"
                            HorizontalOptions="Fill"/>
                </VerticalStackLayout>
            </Frame>

            <!-- Sobre -->
            <Frame>
                <VerticalStackLayout Spacing="10">
                    <Label Text="Sobre" FontSize="20" FontAttributes="Bold"/>
                    
                    <Label Text="{Binding AppVersion}" FontSize="14" TextColor="Gray"/>
                    <Label Text="© 2025 Avila Ops" FontSize="12" TextColor="Gray"/>
                    
                    <HorizontalStackLayout Spacing="10" HorizontalOptions="Center">
                        <Button Text="Termos de Uso" 
                                Command="{Binding TermsCommand}"
                                Style="{StaticResource LinkButton}"/>
                        <Label Text="|" VerticalOptions="Center"/>
                        <Button Text="Privacidade" 
                                Command="{Binding PrivacyCommand}"
                                Style="{StaticResource LinkButton}"/>
                    </HorizontalStackLayout>
                </VerticalStackLayout>
            </Frame>

            <!-- Logout -->
            <Button Text="Sair da Conta" 
                    Command="{Binding LogoutCommand}"
                    BackgroundColor="Transparent"
                    BorderColor="{StaticResource Primary}"
                    BorderWidth="2"
                    TextColor="{StaticResource Primary}"
                    HorizontalOptions="Fill"
                    Margin="0,20,0,0"/>

        </VerticalStackLayout>
    </ScrollView>
</ContentPage>
